<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase Firestore Example</title>

  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
</head>
<body>
    <h1>Firebase Firestore CRUD Example</h1>
    
    
    <h2>Firestore Operations</h2>
    <button onclick="addUser()">Add User</button>
    <button onclick="readUser()">Read User</button>
    <button onclick="updateUser()">Update User</button>
    <button onclick="deleteUser()">Delete User</button>
    <pre id="result"></pre>

    <script>
        let resultElement = document.getElementById("result");

        // **1. Firebase Configuration**
        const firebaseConfig = {
            apiKey: "AIzaSyBb2-D3G0xvbMepV1RtFCawFMbQpVaplj4",
            authDomain: "test-efac0.firebaseapp.com",
            databaseURL: "https://test-efac0-default-rtdb.firebaseio.com",
            projectId: "test-efac0",
            storageBucket: "test-efac0.appspot.com",
            messagingSenderId: "281809758982",
            appId: "1:281809758982:web:470e75aeebfc659bf74c87",
            measurementId: "G-M4C9K5211J"
        };

        // **2. Initialize Firebase**
        firebase.initializeApp(firebaseConfig);

        // **3. Initialize Firestore & Authentication**
        const firestore = firebase.firestore();
        const auth = firebase.auth();

        // **4. Authentication Functions**
        

        // **5. Firestore CRUD Operations**
        function addUser() {
            const userName = prompt("Enter user name:");
            const userAge = prompt("Enter user age:");
            const userCity = prompt("Enter user city:");

            firestore.collection("users").add({
                name: userName,
                age: parseInt(userAge),
                city: userCity
            }).then((docRef) => {
                console.log("Document written with ID:", docRef.id);
                resultElement.innerText = "User added with ID: " + docRef.id;
            }).catch((error) => {
                console.error("Error adding document:", error);
            });
        }

        function readUser() {
            const userId = prompt("Enter user ID to read:");

            firestore.collection("users").doc(userId).get().then((doc) => {
                if (doc.exists) {
                    console.log("Document data:", doc.data());
                    resultElement.innerText = "User Data: " + JSON.stringify(doc.data(), null, 2);
                } else {
                    console.log("No such document!");
                    resultElement.innerText = "No such document!";
                }
            }).catch((error) => {
                console.log("Error getting document:", error);
            });
        }

        function updateUser() {
            const userId = prompt("Enter user ID to update:");
            const newAge = prompt("Enter new age:");

            firestore.collection("users").doc(userId).update({
                age: parseInt(newAge)
            }).then(() => {
                console.log("Document successfully updated!");
                resultElement.innerText = "User age updated!";
            }).catch((error) => {
                console.error("Error updating document:", error);
            });
        }

        function deleteUser() {
            const userId = prompt("Enter user ID to delete:");

            firestore.collection("users").doc(userId).delete().then(() => {
                console.log("Document successfully deleted!");
                resultElement.innerText = "User deleted!";
            }).catch((error) => {
                console.error("Error deleting document:", error);
            });
        }

        // **6. Real-Time Listener**
        auth.onAuthStateChanged(function(user) {
            if (user) {
                console.log("User is signed in:", user);
            } else {
                console.log("No user is signed in.");
            }
        });
    </script>
</body>
</html>